UPDATE stretchy_report
SET report_sql = 'select tr.id AS LOAN_TRANSACTION_NO,\ntr.amount AS AMOUNT,\nl.id AS LOAN_ID, \nl.account_no AS LOAN_ACCOUNT_NO,\ng.external_id AS GROUP_EXTERNAL_ID,\noffice.name AS BRANCH,\ntr.transaction_date AS TRANSACTION_DATE,\npd.payment_type_id as PAYMENT_TYPE,\nIF(tr.transaction_type_enum = 1,"Disbursement","Client Payment") as TRANSACTION_TYPE\nFROM m_office office \nJOIN m_office ounder on ounder.hierarchy like concat(office.hierarchy,"%") \nand ounder.hierarchy like concat((select ino.hierarchy from m_office ino where ino.id = ${officeId}),"%" ) \nJOIN m_loan_transaction tr ON  tr.office_id = office.id and (tr.transaction_type_enum in (1,2,8) and tr.is_reversed = 0 \nand tr.is_reconciled = 0 and tr.id IS NOT NULL)\nLEFT JOIN m_payment_detail pd on(tr.payment_detail_id = pd.id)\nLEFT JOIN m_loan l ON (tr.loan_id = l.id)\nLEFT JOIN m_group g ON g.id=l.group_id\nwhere ${searchCriteria}\ngroup by tr.id order by tr.id desc'
where report_name = 'LoanTransactionsForPaymentReconciliation';
