INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('Loan Repayment Reminders', 'Table', NULL, 'loan', 'select a.client_name,a.branch_name,a.due_date,a.mobile_no,a.loan_id ,a.client_id ,a.productshort_name from\n(select c.display_name as client_name,o.name as branch_name, lrc.duedate as due_date,c.mobile_no as mobile_no,lrc.loan_id as loan_id,c.id as client_id,\nmp.short_name as productShort_name,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(lrc.duedate,\'${startDate}\')),null) as days \n from m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id\n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id     \n     inner join m_office o on c.office_id=o.id\n     where  lrc.completed_derived=0\n     and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=1\n	  and  a.days<=5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a.client_name,a.branch_name,a.due_date,a.mobile_no,a.loan_id ,a.client_id ,a.productshort_name from\n(select c.display_name as client_name,o.name as branch_name, lrc.duedate as due_date,c.mobile_no as mobile_no,lrc.loan_id as loan_id,c.id as client_id,\nmp.short_name as productShort_name,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(lrc.duedate,\'${startDate}\')),null) as days \n from m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id\n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id     \n     inner join m_office o on c.office_id=o.id\n     where  lrc.completed_derived=0\n     and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=1\n	  and  a.days<=5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('Loan First Overdue Repayment Reminder', 'Table', NULL, 'loans', 'select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name,a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,\nsum((ifnull(lrc.principal_amount,0)+ifnull(interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(interest_completed_derived,0)))as overdue_amount,\nif (((lrc.principal_amount+ifnull(lrc.interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',lrc.duedate)),null) as days \n \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id\n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1	      \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=5\n	  and  a.days<10', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name,a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,\nsum((ifnull(lrc.principal_amount,0)+ifnull(interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(interest_completed_derived,0)))as overdue_amount,\nif (((lrc.principal_amount+ifnull(lrc.interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',lrc.duedate)),null) as days \n \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id\n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1	      \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=5\n	  and  a.days<10';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('Loan Second Overdue Repayment Reminder', 'Table', NULL, 'loans', 'select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name, a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,lrc.duedate as duedate, \nsum((ifnull(lrc.principal_amount,0)+ifnull(interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(interest_completed_derived,0)))as overdue_amount,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) month),interval 5 day))),null) as days  \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id \n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1       \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\nwhere	 a.days>=0\nand   a.days<5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name, a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,lrc.duedate as duedate, \nsum((ifnull(lrc.principal_amount,0)+ifnull(interest_amount,0))-(ifnull(lrc.principal_completed_derived,0)+ifnull(interest_completed_derived,0)))as overdue_amount,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) month),interval 5 day))),null) as days  \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id \n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1       \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\nwhere	 a.days>=0\nand   a.days<5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('Loan Third Overdue Repayment Reminder', 'Table', NULL, 'loans', 'select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,productshort_Name,a.Guarantor_mobile_no\nfrom\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate\n,lrc.duedate as duedate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name, \nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +1 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id \ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand   gu.is_active=1\nand l.loan_status_id=300\ngroup by gu.id\n )a\n  where a.days>=0\n and a.days<5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,productshort_Name,a.Guarantor_mobile_no\nfrom\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate\n,lrc.duedate as duedate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name, \nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +1 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id \ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand   gu.is_active=1\nand l.loan_status_id=300\ngroup by gu.id\n )a\n  where a.days>=0\n and a.days<5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('Loan Fourth Overdue Repayment Reminder', 'Table', NULL, 'loans', 'select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,a.productshort_Name,a.Guarantor_mobile_no  from\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate\n,lrc.duedate as duedate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +2 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id\ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand   gu.is_active=1\nand l.loan_status_id=300\ngroup by gu.id\n )a\n   where a.days>=0\nand a.days<5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,productshort_Name,a.Guarantor_mobile_no\nfrom\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate\n,lrc.duedate as duedate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name, \nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +1 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id \ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand   gu.is_active=1\nand l.loan_status_id=300\ngroup by gu.id\n )a\n  where a.days>=0\n and a.days<5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('DefaultWarning -  guarantors', 'Table', NULL, 'loans', 'select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,productshort_Name,a.Guarantor_mobile_no,a.comitted_Shares\nfrom\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,sa.on_hold_funds_derived as comitted_Shares, \nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +3 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id \ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\nleft join m_savings_account sa on sa.client_id=gu.entity_id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand l.loan_status_id=300\nand   gu.is_active=1\ngroup by gu.id\n )a\n	  where a.days>=0\n   and a.days<5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a .client_name,a.Guarantor_name,a.Guarantor_Branch,a.client_mobile_no,a.loan_id,a.client_id,productshort_Name,a.Guarantor_mobile_no,a.comitted_Shares\nfrom\n(select cl.display_name as client_name\n,ifnull(go.display_name,concat(gu.firstname,\' \',gu.lastname)) as Guarantor_name\n,ifnull(o.name,\'NA\') as Guarantor_Branch\n,ifnull(go.mobile_no,gu.mobile_number) as Guarantor_mobile_no\n,co.name as Client_Branch\n,ifnull(cl.mobile_no,\'NA\') as client_mobile_no\n,min(lrc.duedate)as mindate,\ncl.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,sa.on_hold_funds_derived as comitted_Shares, \nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +3 month),interval 5 day))),null) as days  \nfrom m_loan l\ninner join m_product_loan mp on mp.id=l.product_id \ninner join m_client cl on cl.id=l.client_id \ninner join m_guarantor gu on gu.loan_id=l.id\nleft join m_savings_account sa on sa.client_id=gu.entity_id\ninner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\nleft join m_client go on go.id=gu.entity_id\nleft join m_office o on o.id=go.office_id\nleft join m_office co on co.id=cl.office_id\nwhere lrc.completed_derived=0\nand l.loan_status_id=300\nand   gu.is_active=1\ngroup by gu.id\n )a\n	  where a.days>=0\n   and a.days<5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('DefaultWarning - Clients', 'Table', NULL, 'loans', 'select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name, a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,lrc.duedate as duedate, \n(l.principal_outstanding_derived+l.interest_outstanding_derived) as overdue_amount,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +3 month),interval 5 day))),null) as days   \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id \n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1       \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=0\n         and a.days<5', NULL, 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a.client_name,a.branch_name,a.overdue_amount,a.mobile_no,a.loan_id,a.client_id,a.productshort_Name, a.month from\n(select c.display_name as client_name,o.name as branch_name, c.mobile_no as mobile_no,date_format(lrc.duedate,\'%M \')as month,\nc.id as client_id,l.id as loan_id,mp.short_name as productshort_Name,lrc.duedate as duedate, \n(l.principal_outstanding_derived+l.interest_outstanding_derived) as overdue_amount,\nif (((lrc.principal_amount+lrc.interest_amount)-(ifnull(lrc.principal_completed_derived,0)+ifnull(lrc.interest_completed_derived,0))=(lrc.principal_amount+lrc.interest_amount)),(datediff(\'${startDate}\',date_add(date_add(makedate(extract(year from lrc.duedate),extract(day from lrc.duedate)),interval extract(month from lrc.duedate) +3 month),interval 5 day))),null) as days   \nfrom m_client c inner join m_loan l on c.id=l.client_id\n     inner join m_product_loan mp on mp.id=l.product_id \n     inner join m_loan_repayment_schedule lrc on lrc.loan_id=l.id\n     inner join m_office o on c.office_id=o.id\n     where datediff(\'${startDate}\',lrc.duedate)>=1       \n     and  lrc.completed_derived=0\n    and l.loan_status_id=300\n	  group by lrc.loan_id)a\n	  where a.days>=0\n         and a.days<5';
INSERT INTO `stretchy_report` (`report_name`, `report_type`, `report_subtype`, `report_category`, `report_sql`, `description`, `core_report`, `use_report`) VALUES ('DormancyWarning - Clients', 'Table', NULL, 'saving', 'select a.display_name,a.branch_name,a.last_transaction_date,ifnull(a.mobile_no, \'NA\') as mobile_no,a.savings_Id,a.client_Id,a.product_Short_Name from\n(select cl.display_name,sa.product_id,cl.id as client_Id ,cl.default_savings_product,sa.id as savings_Id\n ,mo.name as branch_name,mp.short_name as product_Short_Name,cl.mobile_no as mobile_no,\nMAX(transaction_date)as last_transaction_date ,curdate() as current, datediff(\'${startDate}\',MAX(transaction_date))as days\nfrom m_client cl \ninner join m_office mo on mo.id=cl.office_id\ninner join m_savings_account sa on sa.client_id=cl.id \ninner join m_savings_account_transaction msa on msa.savings_account_id=sa.id \ninner join m_savings_product mp on mp.id=sa.product_id\nwhere sa.product_id in (select  DISTINCT default_savings_product from m_client)\nand msa.transaction_type_enum=1\nand \ncl.status_enum = 300 and \ncl.sub_status =27 \nand sa.status_enum=300\ngroup by sa.account_no)a\nwhere ( MONTH(\'${startDate}\')-MONTH(a.last_transaction_date))=5', 'give details of user which do not deposit any amount in his default saving account for last four month', 0, 1) ON DUPLICATE KEY UPDATE report_sql='select a.display_name,a.branch_name,a.last_transaction_date,ifnull(a.mobile_no, \'NA\') as mobile_no,a.savings_Id,a.client_Id,a.product_Short_Name from\n(select cl.display_name,sa.product_id,cl.id as client_Id ,cl.default_savings_product,sa.id as savings_Id\n ,mo.name as branch_name,mp.short_name as product_Short_Name,cl.mobile_no as mobile_no,\nMAX(transaction_date)as last_transaction_date ,curdate() as current, datediff(\'${startDate}\',MAX(transaction_date))as days\nfrom m_client cl \ninner join m_office mo on mo.id=cl.office_id\ninner join m_savings_account sa on sa.client_id=cl.id \ninner join m_savings_account_transaction msa on msa.savings_account_id=sa.id \ninner join m_savings_product mp on mp.id=sa.product_id\nwhere sa.product_id in (select  DISTINCT default_savings_product from m_client)\nand msa.transaction_type_enum=1\nand \ncl.status_enum = 300 and \ncl.sub_status =27 \nand sa.status_enum=300\ngroup by sa.account_no)a\nwhere ( MONTH(\'${startDate}\')-MONTH(a.last_transaction_date))=5';
